apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: kubekillers.kubekiller.p-program.github.io
spec:
  group: kubekiller.p-program.github.io
  versions:
  - name: v1alpha1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              mode:
                type: string
                enum:
                - demon
                - illidan
                default: illidan
                description: Operation mode - demon kills all pods, illidan hunts unhealthy resources
              interval:
                type: string
                default: "5m"
                description: How often the killer should run (e.g., "5m", "1h"). Ignored if scheduleAt is set.
              scheduleAt:
                type: string
                format: date-time
                description: Specific time to execute the deletion task (RFC3339 format, e.g., "2026-01-15T10:30:00Z"). If set, interval will be ignored and task will run only once at the specified time.
              namespaces:
                type: array
                items:
                  type: string
                description: Namespaces to operate on. Empty means all namespaces except kube-system
              excludeNamespaces:
                type: array
                items:
                  type: string
                description: Namespaces to exclude from operations
              dryRun:
                type: boolean
                default: false
                description: If true, only log what would be deleted without actually deleting
              resources:
                type: array
                items:
                  type: string
                description: Resource types to kill (pod, job, pvc, pv, service, configmap, secret)
          status:
            type: object
            properties:
              lastRunTime:
                type: string
                format: date-time
              lastRunResult:
                type: string
              resourcesKilled:
                type: integer
              phase:
                type: string
    subresources:
      status: {}
  scope: Namespaced
  names:
    plural: kubekillers
    singular: kubekiller
    kind: KubeKiller
    shortNames:
    - kk

